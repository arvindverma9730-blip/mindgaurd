<!DOCTYPE html>
<html>
<head>
  <title>Emotion AI Assistant</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest"></script>
</head>
<body style="text-align:center; font-family:Arial;">
  <h1>Emotion Based Smart Assistant</h1>
  <button onclick="init()">Start Camera</button>
  <div id="webcam-container"></div>
  <h2 id="emotion"></h2>
  <div id="suggestions" style="font-size:20px;"></div>

<script>
  const URL = "./";
  let model, webcam;

  async function init() {
      const modelURL = URL + "model.json";
      const metadataURL = URL + "metadata.json";

      model = await tmImage.load(modelURL, metadataURL);

      webcam = new tmImage.Webcam(300, 300, true);
      await webcam.setup();
      await webcam.play();
      window.requestAnimationFrame(loop);

      document.getElementById("webcam-container").appendChild(webcam.canvas);
  }

  async function loop() {
      webcam.update();
      await predict();
      window.requestAnimationFrame(loop);
  }

  async function predict() {
      const prediction = await model.predict(webcam.canvas);
      let highest = prediction.reduce((a, b) => a.probability > b.probability ? a : b);

      document.getElementById("emotion").innerText = "Detected: " + highest.className;
      showSuggestions(highest.className);
  }

  function showSuggestions(emotion) {
      let suggestions = "";

      if (emotion === "Angry") {
          suggestions = "ğŸ”” You seem stressed!<br>â€¢ Take 5 deep breaths<br>â€¢ Drink water<br>â€¢ Go for short walk";
          alert("You seem Angry! Try calming activities.");
      } 
      else if (emotion === "Sad") {
          suggestions = "ğŸ’™ You look sad.<br>â€¢ Call a friend<br>â€¢ Listen to music<br>â€¢ Write gratitude journal";
      } 
      else if (emotion === "Happy") {
          suggestions = "ğŸ˜Š You're happy!<br>â€¢ Work on big goals<br>â€¢ Help someone<br>â€¢ Exercise";
      } 
      else {
          suggestions = "ğŸ˜ Stay balanced.<br>â€¢ Plan your day<br>â€¢ Focus 25 minutes session";
      }

      document.getElementById("suggestions").innerHTML = suggestions;
  }
</script>
</body>
</html>
